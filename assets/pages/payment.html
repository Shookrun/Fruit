<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Ödəniş</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css"
      integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSB7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link rel="stylesheet" href="../style/payment.css" />
  </head>
  <body>
    <div class="navbars">
      <div class="container">
        <div class="navbar">
          <div class="logo">
            <img src="../images/logo.png" alt="SAM Market Logo" />
            <span class="logo-text"
              ><span>TEZ</span> <span class="market-text">BAZZAR</span></span
            >
          </div>
          <div class="search-bar">
            <input type="text" placeholder="Məhsulu Axtarın" />
            <button><i class="fas fa-search"></i> Axtar</button>
          </div>
          <div class="icons">
            <i class="fas fa-user"></i>
            <i class="fas fa-heart"></i>
            <i class="fas fa-bell"></i>
            <i class="fas fa-shopping-cart"></i>
          </div>
        </div>
        <nav class="menu">
          <a href="../../index.html">Ana Səhifə</a>
          <a href="./mehsullar.html" class="active">Məhsullar</a>
          <a href="#">Haqqımızda</a>
          <a href="#">Əlaqə</a>
          <a href="#">Info</a>
        </nav>
      </div>
    </div>

    <div class="payment-container">
      <h2>Ödəniş Səhifəsi</h2>
     <div class="payment-boxes">
 <div class="cart-summary">
        <h3>Səbətiniz</h3>
        <ul class="cart-items"></ul>
        <div class="cart-total">Cəm: 0.00₼</div>
         <button class="submit-payment">Ödənişi Tamamla</button>
      </div>
     </div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const cartItemsList = document.querySelector(".cart-items");
        const cartTotal = document.querySelector(".cart-total");

        let cart = JSON.parse(localStorage.getItem("cart")) || {};

        function displayCart() {
          cartItemsList.innerHTML = "";
          let grandTotal = 0;

          Object.keys(cart).forEach((productName) => {
            const item = cart[productName];
            grandTotal += parseFloat(item.totalPrice);

            const cartItem = document.createElement("li");
            cartItem.classList.add("cart-item");
            cartItem.innerHTML += `
              <img src="${item.image}" alt="${productName}" width="50" height="50">
              <div class="item-details">
                <span class="item-name">${productName}</span>
                <span class="item-price">${item.basePrice}₼/kg</span>
                <span class="item-weight">${item.weight.toFixed(1)} kg</span>
                <span class="item-total">Cəm: ${item.totalPrice}₼</span>
              </div>
             
            `;
            cartItemsList.appendChild(cartItem);

         
         
          });

          cartTotal.textContent = `Cəm: ${grandTotal.toFixed(2)}₼`;
        }

        displayCart();

        const paymentForm = document.querySelector(".payment-form");
        const submitButton = document.querySelector(".submit-payment");

        submitButton.addEventListener("click", function (e) {
          e.preventDefault();
          const cardNumber = document.querySelector("#card-number").value;
          const cardHolder = document.querySelector("#card-holder").value;
          const expiryDate = document.querySelector("#expiry-date").value;
          const cvv = document.querySelector("#cvv").value;

          if (!cardNumber || !cardHolder || !expiryDate || !cvv) {
            alert("Zəhmət olmasa bütün sahələri doldurun!");
            return;
          }

          if (!/^\d{16}$/.test(cardNumber.replace(/\s/g, ""))) {
            alert("Kart nömrəsi 16 rəqəm olmalıdır!");
            return;
          }

          if (!/^\d{2}\/\d{2}$/.test(expiryDate)) {
            alert("Son istifadə tarixi MM/YY formatında olmalıdır!");
            return;
          }

          if (!/^\d{3}$/.test(cvv)) {
            alert("CVV 3 rəqəm olmalıdır!");
            return;
          }

          alert("Ödəniş məlumatları qeydə alındı. Backend tərəfindən emal ediləcək.");
        });
      });
    </script>
  </body>
</html>